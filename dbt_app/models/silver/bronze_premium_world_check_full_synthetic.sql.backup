{{
    config(
        materialized='incremental',
        unique_key='uid',
    ) 
}}

SELECT
    uid,
    last_name,
    first_name,
    aliases,
    low_quality_aliases,
    alternative_spelling,
    category,
    title,
    `sub-category` AS sub_category,
    position,
    age,
    dob as date_of_birth,
    dobs as date_of_births,
    place_of_birth,
    deceased,
    passports,
    ssn,
    identification_numbers,
    locations,
    countries,
    citizenship,
    companies,
    `e/i` AS e_i,
    linked_to,
    further_information,
    keywords,
    external_sources,
    update_category,
    editor,
    `age_date_(as_of_date)` as age_date,
    pep_roles,
    pep_status,
    special_interest_categories,
    {{ to_utc_date_if_not_null('entered') }} as created_at,
    {{ to_utc_date_if_not_null('updated') }} as updated_at,
    toTimeZone(now64(), 'UTC') as inserted_at
FROM
    `premium-world-check-full-synthetic`


{{
    config(
        materialized='incremental',
        unique_key='uid',
    ) 
}}

SELECT
    `Summons Number` as summons_number
    `Plate ID` as plate_id
    `Registration State` as registration_state
    `Plate Type` as plate_type
    `Issue Date`
    `Violation Code` as
    `Vehicle Body Type`
    `Vehicle Make`
    `Issuing Agency`
    `Street Code1` as
    `Street Code2` as
    `Street Code3` as
    `Vehicle Expiration` Date as
    `Violation Location` as
    `Violation Precinct` as
    `Issuer Precinct` as
    `Issuer Code` as
    `Issuer Command`
    `Issuer Squad`
    `Violation Time`
    `Time First Observed`
    `Violation County`
    `Violation In Front Of Or Opposite`
    `House Number`
    `Street Name`
    `Intersecting Street`
    `Date First Observed` as
    `Law Section` as
    `Sub Division`
    `Violation Legal Code`
    `Days Parking In Effect`
    `From Hours In Effect`
    `To Hours In Effect`
    Vehicle Color
    Unregistered Vehicle? as
    Vehicle Year as
    Meter Number as
    Feet From Curb as
    Violation Post Code as
    Violation Description
    No Standing or Stopping Violation as
    Hydrant Violation as
    Double Parking Violation as

    uid,
    last_name,
    first_name,
    aliases,
    low_quality_aliases,
    alternative_spelling,
    category,
    title,
    `sub-category` AS sub_category,
    position,
    age,
    dob as date_of_birth,
    dobs as date_of_births,
    place_of_birth,
    deceased,
    passports,
    ssn,
    identification_numbers,
    locations,
    countries,
    citizenship,
    companies,
    `e/i` AS e_i,
    linked_to,
    further_information,
    keywords,
    external_sources,
    update_category,
    editor,
    `age_date_(as_of_date)` as age_date,
    pep_roles,
    pep_status,
    special_interest_categories,
    {{ to_utc_date_if_not_null('entered') }} as created_at,
    {{ to_utc_date_if_not_null('updated') }} as updated_at,
    toTimeZone(now64(), 'UTC') as inserted_at
FROM
    `premium-world-check-full-synthetic`


`Plate ID` AS plate_id,
    `Registration State` AS registration_state,
    `Plate Type` AS plate_type,
    `Issue Date` AS issue_date,
    `Violation Code` AS violation_code,
    `Vehicle Body Type` AS vehicle_body_type,
    `Vehicle Make` AS vehicle_make,
    `Issuing Agency` AS issuing_agency,
    `Street Code1` AS street_code1,
    `Street Code2` AS street_code2,
    `Street Code3` AS street_code3,
    CAST(
        SUBSTR(CAST(`Vehicle Expiration Date` AS VARCHAR), 1, 4) || '-' ||
        SUBSTR(CAST(`Vehicle Expiration Date` AS VARCHAR), 5, 2) || '-' ||
        SUBSTR(CAST(`Vehicle Expiration Date` AS VARCHAR), 7, 2) 
    AS DATE) AS vehicle_expiration_date,
    `Violation Location` AS violation_location,
    `Violation Precinct` AS violation_precinct,
    `Issuer Precinct` AS issuer_precinct,
    `Issuer Code` AS issuer_code,
    `Issuer Command` AS issuer_command,
    `Issuer Squad` AS issuer_squad,
    `Violation Time` AS violation_time,
    `Time First Observed` AS violation_county,
    `Violation County` AS violation_legal_code,
    `Violation In Front Of Or Opposite` AS violation_in_front_of_or_opposite,
    `House Number` AS house_number,
    `Street Name` AS street_name,
    `Intersecting Street` AS intersecting_street,
    `Law Section` AS law_section,
    `Sub Division` AS sub_division,
    `Violation Legal Code` AS violation_legal_code,
    `Days Parking In Effect` AS days_parking_in_effect,
    `From Hours In Effect` AS from_hours_in_effect,
    `To Hours In Effect` AS to_hours_in_effect,
    `Vehicle Color` AS vehicle_color,
    `Unregistered Vehicle?` AS unregistered_vehicle,
    `Vehicle Year` AS vehicle_year,
    `Meter Number` AS meter_number,
    `Feet From Curb` AS feet_from_curb,
    `Violation Post Code` AS violation_post_code,
    `Violation Description` AS violation_description